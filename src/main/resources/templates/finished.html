<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>CodeLeader</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width">
    <script src="https://cdn.tailwindcss.com"></script>
    <link th:href="@{/css/stylesheet.css}" rel="stylesheet" type="text/css">
    <link th:href="@{/img/icon.svg}" rel="icon">
</head>

<body>
    <header>
        <div class="grid grid-cols-7 border-b border-gray-500 my-3 h-9">
            <div id="status" class="col-span-4 pl-2">
                <h1 class="text-xl"><a href="/home" class="text-slate-200"><img src="/img/icon.svg"
                            class="float-left rounded-full w-7 h-7 mx-2 font-serif"> CodeLeader</a></h1>
            </div>
            <div id="name" class="col-start-5 col-span-3 pr-2">
                <a href="/mypage" class="text-slate-200" th:text="${uname} + ' Lv ' + ${lv} + ' ' + ${rank}"></a>
            </div>
        </div>
    </header>
    <div>
        <a th:href="@{/code/{postId}(postId=${postId})}"><svg xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                class="w-6 h-6 stroke-blue-500 hover:stroke-blue-700 inline-block mb-1 ml-1">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5" />
            </svg></a>
        <h1 class="text-xl text-slate-200 inline-block mx-2" th:text="${codeTitle}"></h1>
        <form th:action="@{/edit/{codeId}(codeId=${codeId})}" method="post" class="inline-block">
            <button type="submit" name="bookmark">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-6 h-6 stroke-blue-500 inline-block mb-1">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z" />
                </svg></button>
        </form>
        <a th:href="@{/memo/{codeId}(codeId=${codeId})}" target="newtab"> <svg xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                class="w-6 h-6 stroke-blue-500 inline-block mb-1">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
            </svg>
        </a>
        <a th:href="${editUrl}" target="newtab"
            class="rounded-md bg-blue-500 border-4 border-blue-500 hover:bg-sky-700 hover:border-sky-700 mx-1">editor</a>
    </div>
    <pre class="code text-md">
    </pre>
    <div class="mt-4 mb-8 flex justify-center inline-block">
        <button class="rounded-md bg-teal-800 border-4 border-teal-800 inline-block mx-1">
            finish</button>
    </div>
    <footer>
        <div class="grid grid-cols-8 bg-[#2d2b2b]">
            <div id="menu" class="col-start-2 col-span-2"><a href="/home" class="current"><svg
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6 mx-auto">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                    </svg>
                </a></div>
            <div id="menu" class="col-start-4 col-span-2"><a href="/code"><svg xmlns="http://www.w3.org/2000/svg"
                        fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                        class="w-6 h-6 mx-auto">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M14.25 9.75L16.5 12l-2.25 2.25m-4.5 0L7.5 12l2.25-2.25M6 20.25h12A2.25 2.25 0 0020.25 18V6A2.25 2.25 0 0018 3.75H6A2.25 2.25 0 003.75 6v12A2.25 2.25 0 006 20.25z" />
                    </svg>
                </a></div>
            <div id="menu" class="col-start-6 col-span-2"><a href="/mypage"><svg xmlns="http://www.w3.org/2000/svg"
                        fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                        class="w-6 h-6 mx-auto">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                    </svg>
                </a></div>
        </div>
    </footer>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script th:inline="javascript">
    function escape_html(string) {
        if (typeof string !== 'string') {
            return string;
        }
        return string.replace(/[&'`"<>]/g, function (match) {
            return {
                '&': '&amp;',
                "'": '&#x27;',
                '`': '&#x60;',
                '"': '&quot;',
                '<': '&lt;',
                '>': '&gt;',
            }[match]
        });
    }

    async function fetchData() {
        const data = await fetch(/*[[${codeUrl}]]*/);
        const text = await data.text();
        const res = await text.split(/\r\n|\n/);
        for (var line = 0; line < res.length; line++) {
            res[line] = escape_html(res[line]);
            $('.code').append('<span>' + '<pre><code>' + res[line] + '</code></pre>' + '</span>');
        }
    }
    fetchData();
</script>